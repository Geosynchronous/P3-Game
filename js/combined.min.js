!function(){function e(e){e instanceof Array?e.forEach(function(e){t(e)}):t(e)}function t(e){if(o[e])return o[e];var t=new Image;t.onload=function(){o[e]=t,i()&&r.forEach(function(e){e()})},o[e]=!1,t.src=e}function n(e){return o[e]}function i(){var e=!0;for(var t in o)o.hasOwnProperty(t)&&!o[t]&&(e=!1);return e}function a(e){r.push(e)}var o={},r=[];window.Resources={load:e,get:n,onReady:a,isReady:i}}();var updateScore=!1,collision=!1,heartCapture=0,Enemy=function(e,t,n,i,a){var o=83,r=600,s=63,l=-95;this.enemyXend=r,this.enemyXstart=l,this.velocity=e,this.jitter=t,this.rogue=n,this.row=i,this.random=a,this.sprite="images/enemy-bug.png",this.x=l,this.y=this.row*o+s,this.ySign=1};Enemy.prototype.update=function(e){this.x>=this.enemyXend&&(this.x=this.enemyXstart);var t=100,n=t*this.velocity*e,i=10,a=i*Math.sin(this.x);this.jitter||(a=0),this.random&&(n*=1-Math.random()),this.x=this.x+n+a,this.rogue===!0&&this.y<250&&this.rogue===!0&&this.y>50?this.y=this.y-.2*this.ySign:this.rogue===!0&&this.y<=50?(this.ySign=-1*this.ySign,this.y=55):this.rogue===!0&&this.y>=250&&(this.ySign=-1*this.ySign,this.y=245)},Enemy.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)},Enemy.prototype.collide=function(){player.loc();var e=playerX+33,t=this.x,n=t+100,i=playerY+115,a=this.y+70,o=a+67;e>=t&&n>=e&&i>=a&&o>=i&&(collision=!0,player.reset())};var Player=function(){var e=380,t=203;this.Ystart=e,this.Xstart=t,this.x=t,this.y=e,this.sprite="images/char-cat-girl.png"};Player.prototype.reset=function(){this.x=this.Xstart,this.y=this.Ystart},Player.prototype.update=function(){Player.prototype.handleInput=function(e){var t=15+10*heartCapture,n=0,i=1,a=380,o=400;"up"===e&&this.y>=n?this.y=this.y-t:"down"===e&&this.y<=a?this.y=this.y+t:"right"===e&&this.x<=o?this.x=this.x+t:"left"===e&&this.x>=i&&(this.x=this.x-t),this.y<=5&&(updateScore=!0)}},Player.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)},Player.prototype.loc=function(){return playerX=this.x,playerY=this.y,playerX,playerY},Player.prototype.heartCapture=function(){player.loc();var e=playerX+33,t=201,n=t+100,i=playerY+115,a=165;heartBottomY=a+100,2>heartCapture&&e>=t&&n>=e&&i>=a&&i<=heartBottomY&&(heartCapture=1,player.reset())};var allEnemies=[],UpdateEnemyLevel=function(e){switch(e){case 1:allEnemies[allEnemies.length]=new Enemy(.6,!1,!1,0,!1),allEnemies[allEnemies.length]=new Enemy(.8,!0,!1,1,!1),allEnemies[allEnemies.length]=new Enemy(1,!1,!1,2,!1);break;case 2:allEnemies[2].jitter=!0;break;case 3:allEnemies[0].jitter=!0;break;case 4:allEnemies[allEnemies.length]=new Enemy(2,!0,!0,2,!1);break;case 5:allEnemies[allEnemies.length]=new Enemy(1,!0,!0,0,!0),allEnemies[allEnemies.length]=new Enemy(2,!0,!0,2,!0)}},player=new Player;document.addEventListener("keyup",function(e){var t={37:"left",38:"up",39:"right",40:"down"};player.handleInput(t[e.keyCode])});var ScoreBoardRender=function(){var e=ctx.createLinearGradient(0,0,0,50);e.addColorStop(0,"#666666"),e.addColorStop(1,"#000"),ctx.fillStyle=e,ctx.fillRect(0,0,505,47)},LifeCycleRender=function(e){ctx.fillStyle="#fbcc09",ctx.textBaseline="top",ctx.font="bold 24px sans-serif",ctx.fillText("LIFECYCLE",170,10),ctx.fillText(e,320,10)},ScoreRender=function(e){ctx.fillStyle="#fbcc09",ctx.textBaseline="top",ctx.font="bold 24px sans-serif",ctx.fillText("Score: ",10,10),ctx.fillText(e,100,10)},TitleRender=function(){ctx.fillStyle="#000",ctx.textBaseline="top",ctx.font="bold 32px sans-serif",ctx.fillText("J I T T E R   B U G S",103+2*Math.cos(Date.now()),534+2*Math.cos(Date.now())),ctx.fillStyle="#fff",ctx.textBaseline="top",ctx.font="bold 32px sans-serif",ctx.fillText("J I T T E R   B U G S",101+Math.sin(Date.now()),529+Math.cos(Date.now())),ctx.fillStyle="#fbcc09",ctx.textBaseline="top",ctx.font="bold 32px sans-serif",ctx.fillText("J I T T E R   B U G S",101+Math.cos(Date.now()),530)},MakeButton=function(e,t,n){this.xBegin=e,this.yBegin=7,this.xEnd=88,this.yEnd=33,this.text=t,this.xt=n,this.yt=12};MakeButton.prototype.render=function(){var e=ctx.createLinearGradient(0,0,0,70);e.addColorStop(0,"#cc0000"),e.addColorStop(1,"#000"),ctx.fillStyle="#936c6c",ctx.fillRect(this.xBegin+2,this.yBegin+1,this.xEnd-1,this.yEnd),ctx.fillStyle=e,ctx.fillRect(this.xBegin,this.yBegin,this.xEnd,this.yEnd),ctx.fillStyle="#fff",ctx.textBaseline="top",ctx.font="bold 20px sans-serif",ctx.fillText(this.text,this.xt,this.yt)};var playButton=new MakeButton(7,"Play",28),infoButton=new MakeButton(410,"Info",437),doneButton=new MakeButton(410,"Done",430),resetButton=new MakeButton(410,"Reset",427),nextButton=new MakeButton(410,"Next",430),backButton=new MakeButton(410,"Back",430),MessageWindowRender=function(){var e=ctx.createLinearGradient(0,0,0,300);e.addColorStop(0,"transparent"),e.addColorStop(1,"rgba(0, 0, 0, 0.9"),ctx.fillStyle=e,ctx.fillRect(0,50,505,460)},InfoRender=function(){ctx.fillStyle="#fbcc09",ctx.textBaseline="top",ctx.font="bold 24px sans-serif",ctx.fillText("INFO",20,70),ctx.font="bold 18px sans-serif",ctx.fillText("When the PLAY button is clicked, a PLAYER appears",20,110),ctx.fillText("on the grass.  Pressing the arrow keys on keyboard",20,130),ctx.fillText("moves the PLAYER a step in the direction of the key.",20,150),ctx.fillText("A point is scored if the PLAYER can get to the water.",20,190),ctx.fillText("If a PLAYER hits a BUG, the GAME IS OVER and all",20,210),ctx.fillText("the points won will be lost.",20,230),ctx.fillText("When PLAYER scores 10 points they win the GAME!",20,270),ctx.fillText("Winning a GAME starts the next LIFECYCLE. It is then",20,290),ctx.fillText("up to the PLAYER to figure things out.",20,310),ctx.fillText("There are five increasingly difficult LIFECYCLES to",20,350),ctx.fillText("WIN to become a JEDI JITTERBUGGING MASTER.",20,370),ctx.fillStyle="#cc0000",ctx.fillText("WARNING: These bugs are experiencing an epidemic",20,410),ctx.fillText("of a once thought to be extinct JITTER VIRUS that is",20,430),ctx.fillText("rapidly evolving strange behavioural phenotypes.",20,450),ctx.drawImage(Resources.get("images/enemy-bug.png"),-20-10*Math.random(),400)},GameOverRender=function(){ctx.fillStyle="#fbcc09",ctx.textBaseline="top",ctx.font="bold 72px sans-serif",ctx.fillText("GAME",140,200-3*Math.cos(Date.now())),ctx.fillText("OVER",140,280+3*Math.cos(Date.now())),ctx.drawImage(Resources.get("images/char-cat-girl.png"),10,400)},WonGameRender=function(){ctx.fillStyle="#fbcc09",ctx.textBaseline="top",ctx.font="bold 72px sans-serif",ctx.fillText("YOU",170,200-3*Math.cos(Date.now())),ctx.fillText("WIN!",170,280+3*Math.cos(Date.now())),ctx.drawImage(Resources.get("images/char-cat-girl.png"),10,400)},NinjaRender=function(){ctx.fillStyle="#fbcc09",ctx.textBaseline="top",ctx.font="bold 72px sans-serif",ctx.fillText("NINJA!!!",110,170-3*Math.cos(Date.now())),ctx.drawImage(Resources.get("images/star.png"),201,240)},HeartCaptureRender=function(){ctx.fillStyle="#fbcc09",ctx.textBaseline="top",ctx.font="bold 24px sans-serif",ctx.fillText("CONGRATULATIONS!!!",20,70),ctx.font="bold 18px sans-serif",ctx.fillText("You now have improved cardio capabilities.",20,110),ctx.fillText("This means you can now move faster than before.",20,130),ctx.fillText("Click the BACK button to continue the game.",20,150),ctx.drawImage(Resources.get("images/heart.png"),201,200)},GameOverWindowRender=function(){MessageWindowRender(),GameOverRender()},HeartCaptureWindowRender=function(){MessageWindowRender(),HeartCaptureRender()},InfoWindowRender=function(){MessageWindowRender(),InfoRender()},WonGameWindowRender=function(){MessageWindowRender(),WonGameRender()},NinjaWindowRender=function(){MessageWindowRender(),NinjaRender()},HeartRender=function(){ctx.drawImage(Resources.get("images/heart.png"),201,165)},Engine=function(e){function t(){var e=Date.now(),n=(e-w)/1e3;i(n),r(),w=e,T.requestAnimationFrame(t)}function n(){R(),UpdateEnemyLevel(I),w=Date.now(),t()}function i(e){a(e),g(),m(),o()}function a(e){allEnemies.forEach(function(t){t.update(e)}),player.update()}function o(){updateScore&&(W=++W,player.reset(),updateScore=!1),10===W&&5===I?M=!0:10===W&&(k=!0,W=0,I=++I,UpdateEnemyLevel(I))}function r(){var e,t,n=["images/water-block.png","images/stone-block.png","images/stone-block.png","images/stone-block.png","images/grass-block.png","images/grass-block.png"],i=6,a=5;for(e=0;i>e;e++)for(t=0;a>t;t++)S.drawImage(Resources.get(n[e]),101*t,83*e);s(),l(),c(),f(),h(),d(),u(),p(),TitleRender()}function s(){ScoreBoardRender(),LifeCycleRender(I),L()}function l(){I>=4&&1>=heartCapture&&HeartRender()}function c(){allEnemies.forEach(function(e){e.render()}),!v||collision||k||1===heartCapture||player.render()}function f(){C&&(InfoWindowRender(),doneButton.render())}function h(){collision&&(GameOverWindowRender(),nextButton.render())}function d(){1===heartCapture&&(HeartCaptureWindowRender(),backButton.render())}function u(){k&&(WonGameWindowRender(),backButton.render())}function p(){M&&(NinjaWindowRender(),resetButton.render())}function g(){v&&allEnemies.forEach(function(e){e.collide()})}function m(){I>=4&&player.heartCapture()}function R(){v=!1,C=!1,W=0,collision=!1,heartCapture=0,k=!1,M=!1}function E(e){return x=e.clientX-B.offsetLeft,y=e.clientY-B.offsetTop,x>=7&&x<=88&&y>=7&&y<=35&&!C?(v=!0,player.reset()):x>=412&&x<=500&&y>=7&&y<=35&&M?(allEnemies=[],I=1,n()):x>=412&&x<=500&&y>=7&&y<=35&&k?R():x>=412&&x<=500&&y>=7&&y<=35&&1===heartCapture?(heartCapture=2,console.log(heartCapture)):x>=412&&x<=500&&y>=7&&y<=35&&!v&&!C?C=!0:x>=412&&x<=500&&y>=7&&y<=35&&v?R():x>=412&&x<=500&&y>=7&&y<=35&&C&&(C=!1),C}var w,b=e.document,T=e.window,B=b.createElement("canvas"),S=B.getContext("2d"),v=!1,C=!1,I=1,k=!1,M=!1,W=0;B.width=505,B.height=606,b.body.appendChild(B);var L=function(){v?(ScoreRender(W),resetButton.render()):C||G()},G=function(){C||(playButton.render(),infoButton.render())};B.addEventListener("click",E,!1),Resources.load(["images/stone-block.png","images/water-block.png","images/grass-block.png","images/enemy-bug.png","images/char-cat-girl.png","images/heart.png","images/star.png"]),Resources.onReady(n),e.ctx=S}(this);